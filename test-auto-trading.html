<!DOCTYPE html>
<html>
<head>
    <title>Auto Trading Test</title>
</head>
<body>
    <h1>Auto Trading QA Test</h1>
    <button onclick="testScheduler()">Test Auto Trading Scheduler</button>
    <button onclick="checkDatabase()">Check Database</button>
    <div id="results"></div>

    <script>
        const resultsDiv = document.getElementById('results');
        
        async function testScheduler() {
            resultsDiv.innerHTML = '<p>Testing auto trading scheduler...</p>';
            
            try {
                const response = await fetch('https://cgmzxonyaiwtcyxmmhsi.supabase.co/functions/v1/auto-trading-scheduler', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNnbXp4b255YWl3dGN5eG1taHNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5NzA2MzYsImV4cCI6MjA2NzU0NjYzNn0.jv5vMtuiLSmJijipBAVlTwjzXp123IDBA9kslT9kQEM'
                    },
                    body: JSON.stringify({ time: "manual_test" })
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    resultsDiv.innerHTML = `
                        <h3>‚úÖ Scheduler Test Successful</h3>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                } else {
                    resultsDiv.innerHTML = `
                        <h3>‚ùå Scheduler Test Failed</h3>
                        <p>Status: ${response.status}</p>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML = `
                    <h3>‚ùå Scheduler Test Error</h3>
                    <p>${error.message}</p>
                `;
            }
        }
        
        async function checkDatabase() {
            resultsDiv.innerHTML = '<p>Checking database...</p>';
            
            try {
                const response = await fetch('https://cgmzxonyaiwtcyxmmhsi.supabase.co/rest/v1/auto_trades?select=*&order=created_at.desc&limit=10', {
                    headers: {
                        'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNnbXp4b255YWl3dGN5eG1taHNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5NzA2MzYsImV4cCI6MjA2NzU0NjYzNn0.jv5vMtuiLSmJijipBAVlTwjzXp123IDBA9kslT9kQEM',
                        'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6IldPTFVkaW52bEtOQk9EdHUiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2NnbXp4b255YWl3dGN5eG1taHNpLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiJiMTk1ZTM2My04MDAwLTQ0NDAtOTYzMi1mOWFmODNlYjBlOGMiLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzU0MjkwMTg5LCJpYXQiOjE3NTQyODY1ODksImVtYWlsIjoiYW5naGVsLmJvZ2RhbkBvdXRsb29rLmNvbSIsInBob25lIjoiIiwiYXBwX21ldGFkYXRhIjp7InByb3ZpZGVyIjoiZW1haWwiLCJwcm92aWRlcnMiOlsiZW1haWwiXX0sInVzZXJfbWV0YWRhdGEiOnsiZW1haWwiOiJhbmdoZWwuYm9nZGFuQG91dGxvb2suY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInBob25lX3ZlcmlmaWVkIjpmYWxzZSwic3ViIjoiYjE5NWUzNjMtODAwMC00NDQwLTk2MzItZjlhZjgzZWIwZThjIn0sInJvbGUiOiJhdXRoZW50aWNhdGVkIiwiYWFsIjoiYWFsMSIsImFtciI6W3sibWV0aG9kIjoicGFzc3dvcmQiLCJ0aW1lc3RhbXAiOjE3NTIyNjA3Nzd9XSwic2Vzc2lvbl9pZCI6ImM1YzdhMDFjLTM2ZGMtNDExMy1iOTZhLTYxYjE4YTdhNzY0NSIsImlzX2Fub255bW91cyI6ZmFsc2V9.fiSWbptYxFeXYoo3ni01dNqxHrdhUQTaxuivpdohpl8'
                    }
                });
                
                const trades = await response.json();
                
                resultsDiv.innerHTML = `
                    <h3>üìä Database Check</h3>
                    <p>Found ${trades.length} trades</p>
                    <pre>${JSON.stringify(trades, null, 2)}</pre>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `
                    <h3>‚ùå Database Check Error</h3>
                    <p>${error.message}</p>
                `;
            }
        }
    </script>
</body>
</html>